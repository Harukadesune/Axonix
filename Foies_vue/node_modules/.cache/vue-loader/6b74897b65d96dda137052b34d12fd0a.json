{"remainingRequest":"/Users/haruka/IdeaProjects/Axonix/Foies_vue/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/haruka/IdeaProjects/Axonix/Foies_vue/src/views/Helpinfo/index.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/haruka/IdeaProjects/Axonix/Foies_vue/src/views/Helpinfo/index.vue","mtime":1745308249742},{"path":"/Users/haruka/IdeaProjects/Axonix/Foies_vue/node_modules/cache-loader/dist/cjs.js","mtime":1745391003736},{"path":"/Users/haruka/IdeaProjects/Axonix/Foies_vue/node_modules/babel-loader/lib/index.js","mtime":1745391003757},{"path":"/Users/haruka/IdeaProjects/Axonix/Foies_vue/node_modules/cache-loader/dist/cjs.js","mtime":1745391003736},{"path":"/Users/haruka/IdeaProjects/Axonix/Foies_vue/node_modules/vue-loader/lib/index.js","mtime":1745391002124}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCBIZWxwUmVxdWVzdEFQSSBmcm9tICdAL2FwaS9oZWxwaW5mb19hcGknOwoKZXhwb3J0IGRlZmF1bHQgewogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBoZWxwUmVxdWVzdHM6IFtdLAogICAgICBzZWxlY3RlZEhlbHBSZXF1ZXN0czogW10sCiAgICAgIHRvdGFsUmVjb3JkczogMCwKICAgICAgc2VhcmNoRm9ybTogewogICAgICAgIHJlcXVlc3RlcklkOiAnJywKICAgICAgICBoZWxwZXJJZDogJycKICAgICAgfSwKICAgIH07CiAgfSwKCiAgY3JlYXRlZCgpIHsKICAgIHRoaXMuZmV0Y2hIZWxwUmVxdWVzdHMoKTsKICB9LAoKICBtZXRob2RzOiB7CiAgICBhc3luYyBmZXRjaEhlbHBSZXF1ZXN0cygpIHsKICAgICAgY29uc3QgZXhhbXBsZSA9IHsKICAgICAgICBvcmVkQ3JpdGVyaWE6IFt7IGNyaXRlcmlhOiBbXSB9XQogICAgICB9OwoKICAgICAgaWYgKHRoaXMuc2VhcmNoRm9ybS5yZXF1ZXN0ZXJJZCkgewogICAgICAgIGV4YW1wbGUub3JlZENyaXRlcmlhWzBdLmNyaXRlcmlhLnB1c2goewogICAgICAgICAgY29uZGl0aW9uOiAicmVxdWVzdGVyX2lkID0iLAogICAgICAgICAgdmFsdWU6IHRoaXMuc2VhcmNoRm9ybS5yZXF1ZXN0ZXJJZCwKICAgICAgICAgIHNpbmdsZVZhbHVlOiB0cnVlCiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLnNlYXJjaEZvcm0uaGVscGVySWQpIHsKICAgICAgICBleGFtcGxlLm9yZWRDcml0ZXJpYVswXS5jcml0ZXJpYS5wdXNoKHsKICAgICAgICAgIGNvbmRpdGlvbjogImhlbHBlcl9pZCA9IiwKICAgICAgICAgIHZhbHVlOiB0aGlzLnNlYXJjaEZvcm0uaGVscGVySWQsCiAgICAgICAgICBzaW5nbGVWYWx1ZTogdHJ1ZQogICAgICAgIH0pOwogICAgICB9CgogICAgICB0cnkgewogICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgSGVscFJlcXVlc3RBUEkuZ2V0SGVscFJlcXVlc3RzKGV4YW1wbGUpOwogICAgICAgIHRoaXMuaGVscFJlcXVlc3RzID0gcmVzcG9uc2UuZGF0YTsKCiAgICAgICAgLy8g6I635Y+W6K6w5b2V5oC75pWw5bm25pu05pawCiAgICAgICAgY29uc3QgY291bnRSZXNwb25zZSA9IGF3YWl0IEhlbHBSZXF1ZXN0QVBJLmNvdW50SGVscFJlcXVlc3RzKGV4YW1wbGUpOwogICAgICAgIHRoaXMudG90YWxSZWNvcmRzID0gY291bnRSZXNwb25zZS5kYXRhOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoJ+iOt+WPluaxguWKqeiusOW9leWIl+ihqOWksei0pScsIGVycm9yKTsKICAgICAgfQogICAgfSwKCiAgICByZXNldFNlYXJjaCgpIHsKICAgICAgdGhpcy5zZWFyY2hGb3JtID0geyByZXF1ZXN0ZXJJZDogJycsIGhlbHBlcklkOiAnJyB9OwogICAgICB0aGlzLmZldGNoSGVscFJlcXVlc3RzKCk7CiAgICB9LAoKICAgIGhhbmRsZVNlbGVjdGlvbkNoYW5nZShzZWxlY3Rpb24pIHsKICAgICAgdGhpcy5zZWxlY3RlZEhlbHBSZXF1ZXN0cyA9IHNlbGVjdGlvbi5tYXAoaXRlbSA9PiBpdGVtLmlkKTsKICAgIH0sCgogICAgYXN5bmMgaGFuZGxlU3RhdHVzQ2hhbmdlKHJvdykgewogICAgICB0cnkgewogICAgICAgIGF3YWl0IEhlbHBSZXF1ZXN0QVBJLnVwZGF0ZUhlbHBSZXF1ZXN0KHJvdyk7CiAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKCfnirbmgIHmm7TmlrDmiJDlip8nKTsKICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCfnirbmgIHmm7TmlrDlpLHotKUnKTsKICAgICAgICBjb25zb2xlLmVycm9yKCfnirbmgIHmm7TmlrDlpLHotKUnLCBlcnJvcik7CiAgICAgIH0KICAgIH0sCgogICAgYXN5bmMgaGFuZGxlRGVsZXRlKGlkKSB7CiAgICAgIHRoaXMuJGNvbmZpcm0oJ+ehruWumuimgeWIoOmZpOivpeiusOW9leWQl++8nycsICforablkYonLCB7IHR5cGU6ICd3YXJuaW5nJyB9KQogICAgICAgIC50aGVuKGFzeW5jICgpID0+IHsKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIGF3YWl0IEhlbHBSZXF1ZXN0QVBJLmRlbGV0ZUhlbHBSZXF1ZXN0KGlkKTsKICAgICAgICAgICAgdGhpcy5mZXRjaEhlbHBSZXF1ZXN0cygpOyAvLyDliLfmlrDliJfooagKICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKCfliKDpmaTmiJDlip8nKTsKICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+WIoOmZpOWksei0pScpOwogICAgICAgICAgICBjb25zb2xlLmVycm9yKCfliKDpmaTlpLHotKUnLCBlcnJvcik7CiAgICAgICAgICB9CiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goKCkgPT4ge30pOwogICAgfSwKCiAgICBmb3JtYXREYXRlKGRhdGUpIHsKICAgICAgcmV0dXJuIGRhdGUgPyBuZXcgRGF0ZShkYXRlKS50b0xvY2FsZVN0cmluZygpIDogJ+aXoCc7CiAgICB9CiAgfQp9Owo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";AAsDA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/Helpinfo","sourcesContent":["<template>\n  <div class=\"app-container\">\n    <!-- 搜索表单 -->\n    <el-form :inline=\"true\" :model=\"searchForm\" class=\"search-form\">\n      <el-form-item label=\"求助者ID\">\n        <el-input v-model=\"searchForm.requesterId\" placeholder=\"请输入求助者ID\" clearable />\n      </el-form-item>\n      <el-form-item label=\"帮助者ID\">\n        <el-input v-model=\"searchForm.helperId\" placeholder=\"请输入帮助者ID\" clearable />\n      </el-form-item>\n      <el-form-item>\n        <el-button type=\"primary\" @click=\"fetchHelpRequests\">查询</el-button>\n        <el-button @click=\"resetSearch\">重置</el-button>\n      </el-form-item>\n    </el-form>\n\n    <!-- 操作按钮和记录数显示 -->\n    <el-row class=\"action-row\" type=\"flex\" justify=\"space-between\" align=\"middle\">\n      <el-col :span=\"16\"></el-col> <!-- 空列，保持间距 -->\n      <el-col :span=\"8\" class=\"record-count\" style=\"text-align: right;\">\n        <span>当前共有 {{ totalRecords }} 条记录</span>\n      </el-col>\n    </el-row>\n\n    <!-- 求助记录表格 -->\n    <el-table :data=\"helpRequests\" border @selection-change=\"handleSelectionChange\":empty-text=\"'没有数据'\">\n      <el-table-column type=\"selection\" width=\"55\" />\n      <el-table-column prop=\"id\" label=\"ID\" width=\"80\" />\n      <el-table-column prop=\"requesterId\" label=\"求助者ID\" width=\"120\" />\n      <el-table-column prop=\"helperId\" label=\"帮助者ID\" width=\"120\" />\n      <el-table-column prop=\"requesterLng\" label=\"求助者经度\" width=\"120\" />\n      <el-table-column prop=\"requesterLat\" label=\"求助者纬度\" width=\"120\" />\n      <el-table-column prop=\"helperLng\" label=\"帮助者经度\" width=\"120\" />\n      <el-table-column prop=\"helperLat\" label=\"帮助者纬度\" width=\"120\" />\n      <el-table-column prop=\"status\" label=\"状态\" width=\"100\">\n        <template slot-scope=\"scope\">\n          <el-select v-model=\"scope.row.status\" @change=\"handleStatusChange(scope.row)\">\n            <el-option label=\"待处理\" :value=\"0\" />\n            <el-option label=\"处理中\" :value=\"1\" />\n            <el-option label=\"已完成\" :value=\"2\" />\n          </el-select>\n        </template>\n      </el-table-column>\n      <el-table-column prop=\"createdAt\" label=\"创建时间\" width=\"180\">\n        <template slot-scope=\"scope\">{{ formatDate(scope.row.createdAt) }}</template>\n      </el-table-column>\n      <el-table-column prop=\"updatedAt\" label=\"更新时间\" width=\"180\">\n        <template slot-scope=\"scope\">{{ formatDate(scope.row.updatedAt) }}</template>\n      </el-table-column>\n    </el-table>\n  </div>\n</template>\n\n<script>\nimport HelpRequestAPI from '@/api/helpinfo_api';\n\nexport default {\n  data() {\n    return {\n      helpRequests: [],\n      selectedHelpRequests: [],\n      totalRecords: 0,\n      searchForm: {\n        requesterId: '',\n        helperId: ''\n      },\n    };\n  },\n\n  created() {\n    this.fetchHelpRequests();\n  },\n\n  methods: {\n    async fetchHelpRequests() {\n      const example = {\n        oredCriteria: [{ criteria: [] }]\n      };\n\n      if (this.searchForm.requesterId) {\n        example.oredCriteria[0].criteria.push({\n          condition: \"requester_id =\",\n          value: this.searchForm.requesterId,\n          singleValue: true\n        });\n      }\n\n      if (this.searchForm.helperId) {\n        example.oredCriteria[0].criteria.push({\n          condition: \"helper_id =\",\n          value: this.searchForm.helperId,\n          singleValue: true\n        });\n      }\n\n      try {\n        const response = await HelpRequestAPI.getHelpRequests(example);\n        this.helpRequests = response.data;\n\n        // 获取记录总数并更新\n        const countResponse = await HelpRequestAPI.countHelpRequests(example);\n        this.totalRecords = countResponse.data;\n      } catch (error) {\n        console.error('获取求助记录列表失败', error);\n      }\n    },\n\n    resetSearch() {\n      this.searchForm = { requesterId: '', helperId: '' };\n      this.fetchHelpRequests();\n    },\n\n    handleSelectionChange(selection) {\n      this.selectedHelpRequests = selection.map(item => item.id);\n    },\n\n    async handleStatusChange(row) {\n      try {\n        await HelpRequestAPI.updateHelpRequest(row);\n        this.$message.success('状态更新成功');\n      } catch (error) {\n        this.$message.error('状态更新失败');\n        console.error('状态更新失败', error);\n      }\n    },\n\n    async handleDelete(id) {\n      this.$confirm('确定要删除该记录吗？', '警告', { type: 'warning' })\n        .then(async () => {\n          try {\n            await HelpRequestAPI.deleteHelpRequest(id);\n            this.fetchHelpRequests(); // 刷新列表\n            this.$message.success('删除成功');\n          } catch (error) {\n            this.$message.error('删除失败');\n            console.error('删除失败', error);\n          }\n        })\n        .catch(() => {});\n    },\n\n    formatDate(date) {\n      return date ? new Date(date).toLocaleString() : '无';\n    }\n  }\n};\n</script>\n\n<style scoped>\n.app-container {\n  padding: 20px;\n}\n\n.el-table {\n  margin-top: 10px;\n}\n\n.el-button {\n  margin-right: 5px;\n}\n\n.search-form {\n  margin-bottom: 0px;\n}\n\n.record-count {\n  margin-top: 20px;\n  font-size: 14px;\n  color: #606266;\n}\n\n.action-row {\n  margin-bottom: 20px;\n}\n</style>\n"]}]}