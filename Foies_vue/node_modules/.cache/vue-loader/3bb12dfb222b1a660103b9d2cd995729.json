{"remainingRequest":"/Users/haruka/IdeaProjects/Axonix/Foies_vue/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/haruka/IdeaProjects/Axonix/Foies_vue/src/views/Admininfo/index.vue?vue&type=style&index=0&id=4eaafd76&scoped=true&lang=css","dependencies":[{"path":"/Users/haruka/IdeaProjects/Axonix/Foies_vue/src/views/Admininfo/index.vue","mtime":1745308249742},{"path":"/Users/haruka/IdeaProjects/Axonix/Foies_vue/node_modules/css-loader/dist/cjs.js","mtime":1745391002266},{"path":"/Users/haruka/IdeaProjects/Axonix/Foies_vue/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1745391002124},{"path":"/Users/haruka/IdeaProjects/Axonix/Foies_vue/node_modules/postcss-loader/src/index.js","mtime":1745391002227},{"path":"/Users/haruka/IdeaProjects/Axonix/Foies_vue/node_modules/cache-loader/dist/cjs.js","mtime":1745391003736},{"path":"/Users/haruka/IdeaProjects/Axonix/Foies_vue/node_modules/vue-loader/lib/index.js","mtime":1745391002124}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci5hcHAtY29udGFpbmVyIHsKICBwYWRkaW5nOiAyMHB4Owp9CgouZWwtdGFibGUgewogIG1hcmdpbi10b3A6IDIwcHg7Cn0KCi5lbC1idXR0b24gewogIG1hcmdpbi1yaWdodDogNXB4Owp9Cgouc2VhcmNoLWZvcm0gewogIG1hcmdpbi1ib3R0b206IDBweDsKfQoKLmFkZC1hZG1pbi1jb250YWluZXIgewogIG1heC13aWR0aDogNjAwcHg7CiAgbWFyZ2luOiAwIGF1dG87CiAgcGFkZGluZzogMjBweDsKICBiYWNrZ3JvdW5kOiAjZmZmOwogIGJvcmRlci1yYWRpdXM6IDhweDsKICBib3gtc2hhZG93OiAwIDJweCAxMHB4IHJnYmEoMCwgMCwgMCwgMC4xKTsKfQoKLnJlY29yZC1jb3VudCB7CiAgbWFyZ2luLXRvcDogMjBweDsKICBmb250LXNpemU6IDE0cHg7CiAgY29sb3I6ICM2MDYyNjY7Cn0K"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";AA4OA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/Admininfo","sourcesContent":["<template>\n  <div class=\"app-container\">\n    <!-- 搜索表单 -->\n    <el-form :inline=\"true\" :model=\"searchForm\" class=\"search-form\">\n      <el-form-item label=\"用户名\">\n        <el-input v-model=\"searchForm.username\" placeholder=\"请输入用户名\" clearable />\n      </el-form-item>\n      <el-form-item label=\"电话\">\n        <el-input v-model=\"searchForm.phone\" placeholder=\"请输入电话\" clearable />\n      </el-form-item>\n      <el-form-item>\n        <el-button type=\"primary\" @click=\"fetchAdmins\">查询</el-button>\n        <el-button @click=\"resetSearch\">重置</el-button>\n      </el-form-item>\n    </el-form>\n\n    <!-- 操作按钮和记录数显示 -->\n    <el-row class=\"action-row\" type=\"flex\" justify=\"space-between\" align=\"middle\">\n      <el-col :span=\"8\">\n        <el-button type=\"primary\" @click=\"handleAdd\">添加用户</el-button>\n        <el-button type=\"danger\" @click=\"confirmBatchDelete\" :disabled=\"selectedAdmins.length === 0\">批量删除</el-button>\n      </el-col>\n      <el-col :span=\"8\" class=\"record-count\" style=\"text-align: right;\">\n        <span>当前共有 {{ totalRecords }} 条记录</span>\n      </el-col>\n    </el-row>\n\n    <!-- 管理员表格 -->\n    <el-table :data=\"admins\" border @selection-change=\"handleSelectionChange\" :empty-text=\"'没有数据'\">\n      <el-table-column type=\"selection\" width=\"50\" />\n      <el-table-column prop=\"id\" label=\"ID\" />\n      <el-table-column prop=\"username\" label=\"用户名\" />\n      <el-table-column prop=\"phone\" label=\"电话\" />\n      <el-table-column prop=\"createdAt\" label=\"创建时间\">\n        <template slot-scope=\"scope\">{{ formatDate(scope.row.createdAt) }}</template>\n      </el-table-column>\n      <el-table-column prop=\"updatedAt\" label=\"更新时间\">\n        <template slot-scope=\"scope\">{{ formatDate(scope.row.updatedAt) }}</template>\n      </el-table-column>\n      <el-table-column label=\"操作\" width=\"160\" fixed=\"right\">\n        <template slot-scope=\"scope\">\n          <el-button size=\"mini\" @click=\"handleEdit(scope.row)\">编辑</el-button>\n          <el-button size=\"mini\" type=\"danger\" @click=\"handleDelete(scope.row.id)\">删除</el-button>\n        </template>\n      </el-table-column>\n    </el-table>\n\n    <!-- 添加/编辑管理员弹出框 -->\n    <el-dialog :visible.sync=\"dialogVisible\" title=\"管理员信息\" width=\"600px\">\n      <el-form ref=\"adminForm\" :model=\"admin\" :rules=\"rules\" label-width=\"100px\">\n        <el-form-item label=\"用户名\" prop=\"username\">\n          <el-input v-model=\"admin.username\" />\n        </el-form-item>\n\n        <el-form-item label=\"密码\" prop=\"password\">\n          <el-input v-model=\"admin.password\" type=\"password\" />\n        </el-form-item>\n\n        <el-form-item label=\"电话\" prop=\"phone\">\n          <el-input v-model=\"admin.phone\" />\n        </el-form-item>\n\n        <el-form-item>\n          <el-button type=\"primary\" @click=\"submitForm\">保存</el-button>\n          <el-button @click=\"closeDialog\">取消</el-button>\n        </el-form-item>\n      </el-form>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport AdminAPI from '@/api/admin_api';\n\nexport default {\n  data() {\n    return {\n      admins: [],\n      totalRecords: 0,  // 添加记录数\n      selectedAdmins: [],\n      searchForm: {\n        username: '',\n        phone: ''\n      },\n      dialogVisible: false,  // 控制弹出框显示\n      admin: {\n        id: null,\n        username: '',\n        password: '',\n        phone: '',\n        createdAt: '',\n        updatedAt: '',\n      },\n      rules: {\n        username: [{ required: true, message: '请输入用户名', trigger: 'blur' }],\n        password: [{ required: true, message: '请输入密码', trigger: 'blur' }],\n        phone: [{ required: true, message: '请输入电话', trigger: 'blur' }]\n      }\n    };\n  },\n  created() {\n    this.fetchAdmins();\n  },\n  methods: {\n    async fetchAdmins() {\n      const example = {\n        oredCriteria: [{ criteria: [] }]\n      };\n\n      if (this.searchForm.username) {\n        example.oredCriteria[0].criteria.push({\n          condition: \"username LIKE\",\n          value: `%${this.searchForm.username}%`,\n          singleValue: true\n        });\n      }\n\n      if (this.searchForm.phone) {\n        example.oredCriteria[0].criteria.push({\n          condition: \"phone LIKE\",\n          value: `%${this.searchForm.phone}%`,\n          singleValue: true\n        });\n      }\n\n      try {\n        const response = await AdminAPI.getAdmins(example);\n        this.admins = response.data;\n\n        const countResponse = await AdminAPI.countAdmins(example);\n        this.totalRecords = countResponse.data; // 假设返回的是记录总数\n      } catch (error) {\n        console.error('获取管理员列表失败', error);\n      }\n    },\n\n    resetSearch() {\n      this.searchForm = { username: '', phone: '' };\n      this.fetchAdmins();\n    },\n\n    handleSelectionChange(selection) {\n      this.selectedAdmins = selection.map(admin => admin.id);\n    },\n\n    handleAdd() {\n      this.admin = {\n        id: null,\n        username: '',\n        password: '',\n        phone: '',\n        createdAt: '',\n        updatedAt: ''\n      };\n      this.dialogVisible = true;\n    },\n\n    handleEdit(admin) {\n      this.admin = { ...admin };\n      this.dialogVisible = true;\n    },\n\n    async submitForm() {\n      this.$refs.adminForm.validate(async (valid) => {\n        if (valid) {\n          try {\n            if (this.admin.id) {\n              await AdminAPI.updateAdmin(this.admin);\n            } else {\n              await AdminAPI.addAdmin(this.admin);\n            }\n            this.$message.success('管理员信息保存成功');\n            this.dialogVisible = false;\n            this.fetchAdmins();\n          } catch (error) {\n            this.$message.error('保存管理员信息失败');\n            console.error(error);\n          }\n        }\n      });\n    },\n    // 在methods中添加这个方法\n    async handleDelete(id) {\n      this.$confirm('确定要删除此管理员吗？', '警告', {\n        type: 'warning',\n        cancelButtonText: '取消',\n        confirmButtonText: '确定'\n      })\n        .then(async () => {\n          try {\n            await AdminAPI.deleteAdmin(id);\n            this.$message.success('删除成功');\n            this.fetchAdmins(); // 刷新列表\n          } catch (error) {\n            this.$message.error('删除失败');\n            console.error('删除管理员失败', error);\n          }\n        })\n        .catch(() => {\n          this.$message.info('已取消删除');\n        });\n    },\n    closeDialog() {\n      this.dialogVisible = false;\n    },\n\n    confirmBatchDelete() {\n      if (this.selectedAdmins.length === 0) return;\n      this.$confirm('确定要删除选中的管理员吗？', '警告', {\n        type: 'warning',\n        cancelButtonText: '取消',\n        confirmButtonText: '确定'\n      })\n        .then(() => this.handleBatchDelete())\n        .catch(() => { });\n    },\n\n    async handleBatchDelete() {\n      try {\n        await Promise.all(this.selectedAdmins.map(id => AdminAPI.deleteAdmin(id)));\n        this.fetchAdmins();\n        this.selectedAdmins = [];\n        this.$message.success('批量删除成功');\n      } catch (error) {\n        console.error('批量删除失败', error);\n      }\n    },\n\n    formatDate(date) {\n      return date ? new Date(date).toLocaleString() : \"无\";\n    }\n  }\n};\n</script>\n\n<style scoped>\n.app-container {\n  padding: 20px;\n}\n\n.el-table {\n  margin-top: 20px;\n}\n\n.el-button {\n  margin-right: 5px;\n}\n\n.search-form {\n  margin-bottom: 0px;\n}\n\n.add-admin-container {\n  max-width: 600px;\n  margin: 0 auto;\n  padding: 20px;\n  background: #fff;\n  border-radius: 8px;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);\n}\n\n.record-count {\n  margin-top: 20px;\n  font-size: 14px;\n  color: #606266;\n}\n</style>"]}]}